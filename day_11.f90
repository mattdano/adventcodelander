PROGRAM DAY11
  IMPLICIT NONE
  INTEGER :: I,J,K,L,SERIALNUM,GRID(300,300),TOTALS(300,300)
  INTEGER :: PART1(2),PART2(3),BEST

  SERIALNUM =7511

  GRID=RESHAPE((/((/(MODULO(ABS((((I+10)*J+SERIALNUM)*(I+10))/100),10)-5,I=1,300)/),J=1,300)/),(/300,300/))
  BEST=MAXVAL(GRID)
  PART2=(/MAXLOC(GRID),1/)
  TOTALS=GRID

  DO K=2,300
     DO J=1,301-K
        DO I=1,301-K
           TOTALS(I,J)=TOTALS(I,J)+SUM(GRID(I:I+K-1,J+K-1))+SUM(GRID(I+K-1,J:J+K-2))
        END DO
     END DO
     L=MAXVAL(TOTALS)
     IF(L>BEST)THEN
        BEST=L
        PART2=(/MAXLOC(TOTALS),K/)
     END IF
     IF(K.EQ.3)PART1=MAXLOC(TOTALS(1:298,1:298))
  END DO

  WRITE(*,'(A,I0,",",I0)')'Part 1: ',PART1
  WRITE(*,'(A,I0,2(",",I0))')'Part 2: ',PART2
END PROGRAM DAY11

